{"ast":null,"code":"import { createSlice, createAsyncThunk } from '@reduxjs/toolkit';\nimport API from '../api/api';\nconst initUser = JSON.parse(localStorage.getItem('user') || 'null');\nexport const login = createAsyncThunk('auth/login', async (payload, {\n  rejectWithValue\n}) => {\n  try {\n    const res = await API.post('/auth/login', payload);\n    return res.data; // contains { user }\n  } catch (err) {\n    var _err$response, _err$response$data;\n    return rejectWithValue(((_err$response = err.response) === null || _err$response === void 0 ? void 0 : (_err$response$data = _err$response.data) === null || _err$response$data === void 0 ? void 0 : _err$response$data.message) || 'Login failed');\n  }\n});\nexport const register = createAsyncThunk('auth/register', async (payload, {\n  rejectWithValue\n}) => {\n  try {\n    const res = await API.post('/auth/register', payload);\n    return res.data; // contains { user }\n  } catch (err) {\n    var _err$response2, _err$response2$data;\n    return rejectWithValue(((_err$response2 = err.response) === null || _err$response2 === void 0 ? void 0 : (_err$response2$data = _err$response2.data) === null || _err$response2$data === void 0 ? void 0 : _err$response2$data.message) || 'Register failed');\n  }\n});\nconst authSlice = createSlice({\n  name: 'auth',\n  initialState: {\n    user: initUser,\n    loading: false,\n    error: null\n  },\n  reducers: {\n    logout(state) {\n      state.user = null;\n      localStorage.removeItem('user');\n    }\n  },\n  extraReducers: builder => {\n    builder\n    // LOGIN\n    .addCase(login.pending, s => {\n      s.loading = true;\n      s.error = null;\n    }).addCase(login.fulfilled, (s, a) => {\n      s.loading = false;\n      s.user = a.payload.user; // <-- user saved correctly\n      localStorage.setItem('user', JSON.stringify(a.payload.user));\n    }).addCase(login.rejected, (s, a) => {\n      s.loading = false;\n      s.error = a.payload;\n    })\n\n    // REGISTER\n    .addCase(register.pending, s => {\n      s.loading = true;\n      s.error = null;\n    }).addCase(register.fulfilled, (s, a) => {\n      s.loading = false;\n      s.user = a.payload.user;\n      localStorage.setItem('user', JSON.stringify(a.payload.user));\n    }).addCase(register.rejected, (s, a) => {\n      s.loading = false;\n      s.error = a.payload;\n    });\n  }\n});\nexport const {\n  logout\n} = authSlice.actions;\nexport default authSlice.reducer;","map":{"version":3,"names":["createSlice","createAsyncThunk","API","initUser","JSON","parse","localStorage","getItem","login","payload","rejectWithValue","res","post","data","err","_err$response","_err$response$data","response","message","register","_err$response2","_err$response2$data","authSlice","name","initialState","user","loading","error","reducers","logout","state","removeItem","extraReducers","builder","addCase","pending","s","fulfilled","a","setItem","stringify","rejected","actions","reducer"],"sources":["C:/Users/LENOVO/Desktop/employee_attendance_system/frontend/src/features/authSlice.js"],"sourcesContent":["import { createSlice, createAsyncThunk } from '@reduxjs/toolkit';\r\nimport API from '../api/api';\r\n\r\nconst initUser = JSON.parse(localStorage.getItem('user') || 'null');\r\n\r\nexport const login = createAsyncThunk(\r\n  'auth/login',\r\n  async (payload, { rejectWithValue }) => {\r\n    try {\r\n      const res = await API.post('/auth/login', payload);\r\n      return res.data;   // contains { user }\r\n    } catch (err) {\r\n      return rejectWithValue(err.response?.data?.message || 'Login failed');\r\n    }\r\n  }\r\n);\r\n\r\nexport const register = createAsyncThunk(\r\n  'auth/register',\r\n  async (payload, { rejectWithValue }) => {\r\n    try {\r\n      const res = await API.post('/auth/register', payload);\r\n      return res.data;  // contains { user }\r\n    } catch (err) {\r\n      return rejectWithValue(err.response?.data?.message || 'Register failed');\r\n    }\r\n  }\r\n);\r\n\r\nconst authSlice = createSlice({\r\n  name: 'auth',\r\n  initialState: {\r\n    user: initUser,\r\n    loading: false,\r\n    error: null\r\n  },\r\n  reducers: {\r\n    logout(state) {\r\n      state.user = null;\r\n      localStorage.removeItem('user');\r\n    }\r\n  },\r\n  extraReducers: (builder) => {\r\n    builder\r\n      // LOGIN\r\n      .addCase(login.pending, (s) => {\r\n        s.loading = true;\r\n        s.error = null;\r\n      })\r\n      .addCase(login.fulfilled, (s, a) => {\r\n        s.loading = false;\r\n        s.user = a.payload.user;   // <-- user saved correctly\r\n        localStorage.setItem('user', JSON.stringify(a.payload.user));\r\n      })\r\n      .addCase(login.rejected, (s, a) => {\r\n        s.loading = false;\r\n        s.error = a.payload;\r\n      })\r\n\r\n      // REGISTER\r\n      .addCase(register.pending, (s) => {\r\n        s.loading = true;\r\n        s.error = null;\r\n      })\r\n      .addCase(register.fulfilled, (s, a) => {\r\n        s.loading = false;\r\n        s.user = a.payload.user;\r\n        localStorage.setItem('user', JSON.stringify(a.payload.user));\r\n      })\r\n      .addCase(register.rejected, (s, a) => {\r\n        s.loading = false;\r\n        s.error = a.payload;\r\n      });\r\n  }\r\n});\r\n\r\nexport const { logout } = authSlice.actions;\r\nexport default authSlice.reducer;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}