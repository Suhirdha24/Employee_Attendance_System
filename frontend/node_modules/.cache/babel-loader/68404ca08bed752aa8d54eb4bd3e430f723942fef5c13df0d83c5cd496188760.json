{"ast":null,"code":"import { createSlice, createAsyncThunk } from '@reduxjs/toolkit';\nimport API from '../api/api';\n\n// Load user from localStorage (if exists)\nconst initUser = JSON.parse(localStorage.getItem('user') || 'null');\n\n// ----------------------\n// LOGIN\n// ----------------------\nexport const login = createAsyncThunk('auth/login', async (payload, {\n  rejectWithValue\n}) => {\n  try {\n    const res = await API.post('/auth/login', payload);\n    return res.data; // contains { user }\n  } catch (err) {\n    var _err$response, _err$response$data;\n    return rejectWithValue(((_err$response = err.response) === null || _err$response === void 0 ? void 0 : (_err$response$data = _err$response.data) === null || _err$response$data === void 0 ? void 0 : _err$response$data.message) || 'Login failed');\n  }\n});\n\n// ----------------------\n// REGISTER\n// ----------------------\nexport const register = createAsyncThunk('auth/register', async (payload, {\n  rejectWithValue\n}) => {\n  try {\n    const res = await API.post('/auth/register', payload);\n    return res.data; // contains { user }\n  } catch (err) {\n    var _err$response2, _err$response2$data;\n    return rejectWithValue(((_err$response2 = err.response) === null || _err$response2 === void 0 ? void 0 : (_err$response2$data = _err$response2.data) === null || _err$response2$data === void 0 ? void 0 : _err$response2$data.message) || 'Register failed');\n  }\n});\n\n// ----------------------\n// AUTH SLICE\n// ----------------------\nconst authSlice = createSlice({\n  name: 'auth',\n  initialState: {\n    user: initUser,\n    loading: false,\n    error: null\n  },\n  reducers: {\n    logout(state) {\n      state.user = null;\n\n      // Delete user from localStorage\n      localStorage.removeItem('user');\n\n      // Redirect user to Home Page after logout\n      window.location.href = \"/\";\n    }\n  },\n  extraReducers: builder => {\n    builder\n    // LOGIN CASES\n    .addCase(login.pending, s => {\n      s.loading = true;\n      s.error = null;\n    }).addCase(login.fulfilled, (s, a) => {\n      s.loading = false;\n      s.user = a.payload.user;\n\n      // store logged in user\n      localStorage.setItem(\"user\", JSON.stringify(a.payload.user));\n    }).addCase(login.rejected, (s, a) => {\n      s.loading = false;\n      s.error = a.payload;\n    })\n\n    // REGISTER CASES\n    .addCase(register.pending, s => {\n      s.loading = true;\n      s.error = null;\n    }).addCase(register.fulfilled, (s, a) => {\n      s.loading = false;\n      s.user = a.payload.user;\n\n      // store new user\n      localStorage.setItem(\"user\", JSON.stringify(a.payload.user));\n    }).addCase(register.rejected, (s, a) => {\n      s.loading = false;\n      s.error = a.payload;\n    });\n  }\n});\nexport const {\n  logout\n} = authSlice.actions;\nexport default authSlice.reducer;","map":{"version":3,"names":["createSlice","createAsyncThunk","API","initUser","JSON","parse","localStorage","getItem","login","payload","rejectWithValue","res","post","data","err","_err$response","_err$response$data","response","message","register","_err$response2","_err$response2$data","authSlice","name","initialState","user","loading","error","reducers","logout","state","removeItem","window","location","href","extraReducers","builder","addCase","pending","s","fulfilled","a","setItem","stringify","rejected","actions","reducer"],"sources":["C:/Users/LENOVO/Desktop/employee_attendance_system/frontend/src/features/authSlice.js"],"sourcesContent":["import { createSlice, createAsyncThunk } from '@reduxjs/toolkit';\r\nimport API from '../api/api';\r\n\r\n// Load user from localStorage (if exists)\r\nconst initUser = JSON.parse(localStorage.getItem('user') || 'null');\r\n\r\n// ----------------------\r\n// LOGIN\r\n// ----------------------\r\nexport const login = createAsyncThunk(\r\n  'auth/login',\r\n  async (payload, { rejectWithValue }) => {\r\n    try {\r\n      const res = await API.post('/auth/login', payload);\r\n      return res.data;   // contains { user }\r\n    } catch (err) {\r\n      return rejectWithValue(err.response?.data?.message || 'Login failed');\r\n    }\r\n  }\r\n);\r\n\r\n// ----------------------\r\n// REGISTER\r\n// ----------------------\r\nexport const register = createAsyncThunk(\r\n  'auth/register',\r\n  async (payload, { rejectWithValue }) => {\r\n    try {\r\n      const res = await API.post('/auth/register', payload);\r\n      return res.data;  // contains { user }\r\n    } catch (err) {\r\n      return rejectWithValue(err.response?.data?.message || 'Register failed');\r\n    }\r\n  }\r\n);\r\n\r\n// ----------------------\r\n// AUTH SLICE\r\n// ----------------------\r\nconst authSlice = createSlice({\r\n  name: 'auth',\r\n  initialState: {\r\n    user: initUser,\r\n    loading: false,\r\n    error: null,\r\n  },\r\n\r\n  reducers: {\r\n    logout(state) {\r\n      state.user = null;\r\n\r\n      // Delete user from localStorage\r\n      localStorage.removeItem('user');\r\n\r\n      // Redirect user to Home Page after logout\r\n      window.location.href = \"/\";\r\n    }\r\n  },\r\n\r\n  extraReducers: (builder) => {\r\n    builder\r\n      // LOGIN CASES\r\n      .addCase(login.pending, (s) => {\r\n        s.loading = true;\r\n        s.error = null;\r\n      })\r\n      .addCase(login.fulfilled, (s, a) => {\r\n        s.loading = false;\r\n        s.user = a.payload.user;\r\n\r\n        // store logged in user\r\n        localStorage.setItem(\"user\", JSON.stringify(a.payload.user));\r\n      })\r\n      .addCase(login.rejected, (s, a) => {\r\n        s.loading = false;\r\n        s.error = a.payload;\r\n      })\r\n\r\n      // REGISTER CASES\r\n      .addCase(register.pending, (s) => {\r\n        s.loading = true;\r\n        s.error = null;\r\n      })\r\n      .addCase(register.fulfilled, (s, a) => {\r\n        s.loading = false;\r\n        s.user = a.payload.user;\r\n\r\n        // store new user\r\n        localStorage.setItem(\"user\", JSON.stringify(a.payload.user));\r\n      })\r\n      .addCase(register.rejected, (s, a) => {\r\n        s.loading = false;\r\n        s.error = a.payload;\r\n      });\r\n  }\r\n});\r\n\r\nexport const { logout } = authSlice.actions;\r\nexport default authSlice.reducer;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}